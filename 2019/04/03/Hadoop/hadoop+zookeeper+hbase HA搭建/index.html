<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="Hadoop HA高可用集群搭建（Hadoop+Zookeeper+HBase）一、服务器环境    ip 用户名 安装目录（zookeeper,hadoop,hbase）     hadoop1 172.30.0.12 hadoop /home/hadoop/zookeeper,/home/hadoop/hadoop,/home/hadoop/hbase   hadoop2 172.30.0.7">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/2019/04/03/Hadoop/hadoop+zookeeper+hbase HA搭建/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Hadoop HA高可用集群搭建（Hadoop+Zookeeper+HBase）一、服务器环境    ip 用户名 安装目录（zookeeper,hadoop,hbase）     hadoop1 172.30.0.12 hadoop /home/hadoop/zookeeper,/home/hadoop/hadoop,/home/hadoop/hbase   hadoop2 172.30.0.7">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-03-13T02:13:49.325Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description" content="Hadoop HA高可用集群搭建（Hadoop+Zookeeper+HBase）一、服务器环境    ip 用户名 安装目录（zookeeper,hadoop,hbase）     hadoop1 172.30.0.12 hadoop /home/hadoop/zookeeper,/home/hadoop/hadoop,/home/hadoop/hbase   hadoop2 172.30.0.7">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/04/03/Hadoop/hadoop+zookeeper+hbase HA搭建/">





  <title> | Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/03/Hadoop/hadoop+zookeeper+hbase HA搭建/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline"></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-03T15:15:00+08:00">
                2019-04-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Hadoop-HA高可用集群搭建（Hadoop-Zookeeper-HBase）"><a href="#Hadoop-HA高可用集群搭建（Hadoop-Zookeeper-HBase）" class="headerlink" title="Hadoop HA高可用集群搭建（Hadoop+Zookeeper+HBase）"></a>Hadoop HA高可用集群搭建（Hadoop+Zookeeper+HBase）</h1><h3 id="一、服务器环境"><a href="#一、服务器环境" class="headerlink" title="一、服务器环境"></a>一、服务器环境</h3><table>
<thead>
<tr>
<th></th>
<th>ip</th>
<th>用户名</th>
<th>安装目录（zookeeper,hadoop,hbase）</th>
</tr>
</thead>
<tbody>
<tr>
<td>hadoop1</td>
<td>172.30.0.12</td>
<td>hadoop</td>
<td>/home/hadoop/zookeeper,/home/hadoop/hadoop,/home/hadoop/hbase</td>
</tr>
<tr>
<td>hadoop2</td>
<td>172.30.0.7</td>
<td>hadoop</td>
<td>/home/hadoop/zookeeper,/home/hadoop/hadoop,/home/hadoop/hbase</td>
</tr>
<tr>
<td>hadoop3</td>
<td>172.30.0.2</td>
<td>hadoop</td>
<td>/home/hadoop/zookeeper,/home/hadoop/hadoop,/home/hadoop/hbase</td>
</tr>
<tr>
<td>hadoop4</td>
<td>172.30.0.4</td>
<td>hadoop</td>
<td>/home/hadoop/zookeeper,/home/hadoop/hadoop,/home/hadoop/hbase</td>
</tr>
</tbody>
</table>
<h3 id="二、集群规划"><a href="#二、集群规划" class="headerlink" title="二、集群规划"></a>二、集群规划</h3><table>
<thead>
<tr>
<th>hadoop1</th>
<th>hadoop2</th>
<th>hadoop3</th>
<th>hadoop4</th>
</tr>
</thead>
<tbody>
<tr>
<td>NameNode</td>
<td>NameNode</td>
<td></td>
<td></td>
</tr>
<tr>
<td>DataNode</td>
<td>DataNode</td>
<td>DataNode</td>
<td>DataNode</td>
</tr>
<tr>
<td>Zookeeper</td>
<td>Zookeeper</td>
<td>Zookeeper</td>
<td>Zookeeper</td>
</tr>
<tr>
<td>ResourceManager</td>
<td>ResourceManager</td>
<td></td>
<td></td>
</tr>
<tr>
<td>NodeManager</td>
<td>NodeManager</td>
<td>NodeManager</td>
<td>NodeManager</td>
</tr>
<tr>
<td>HMaster</td>
<td>HMasetr</td>
<td></td>
<td></td>
</tr>
<tr>
<td>RegionServer</td>
<td>RegionServer</td>
<td>RegionServer</td>
<td>RegionServer</td>
</tr>
</tbody>
</table>
<p>考虑到HBase与JDK、Hadoop各版本兼容性，我们采用的组件版本如下：</p>
<table>
<thead>
<tr>
<th>组件</th>
<th>版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>JDK</td>
<td>1.8</td>
</tr>
<tr>
<td>Hadoop</td>
<td>2.7.6</td>
</tr>
<tr>
<td>Zookeeper</td>
<td>3.4.10</td>
</tr>
<tr>
<td>HBase</td>
<td>1.2.11</td>
</tr>
</tbody>
</table>
<h3 id="三、安装配置Zookeeper"><a href="#三、安装配置Zookeeper" class="headerlink" title="三、安装配置Zookeeper"></a>三、安装配置Zookeeper</h3><h4 id="1、下载及安装"><a href="#1、下载及安装" class="headerlink" title="1、下载及安装"></a>1、下载及安装</h4><p>下载地址：<a href="http://mirrors.hust.edu.cn/apache/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz" target="_blank" rel="noopener">http://mirrors.hust.edu.cn/apache/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz</a></p>
<p>在master188机器上，下载后解压到/home/hadoop/目录下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf zookeeper-3.4.10.tar.gz -C /home/hadoop/</span><br></pre></td></tr></table></figure>
<h4 id="2、拷贝-zoo-sample-cfg"><a href="#2、拷贝-zoo-sample-cfg" class="headerlink" title="2、拷贝 zoo_sample.cfg"></a>2、拷贝 <code>zoo_sample.cfg</code></h4><p>进入zookeeper的conf目录，拷贝<code>zoo_sample.cfg</code>并重命名为<code>zoo.cfg</code> ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mv zookeeper-3.4.10 zookeeper</span><br><span class="line">cd zookeeper/conf/</span><br><span class="line"></span><br><span class="line">cp zoo_sample.cfg zoo.cfg</span><br></pre></td></tr></table></figure>
<h4 id="3、修改-zoo-cfg"><a href="#3、修改-zoo-cfg" class="headerlink" title="3、修改 zoo.cfg"></a>3、修改 <code>zoo.cfg</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi zoo.cfg</span><br></pre></td></tr></table></figure>
<p>修改如下，若原文件没有dataDir则直接添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dataDir=/home/hadoop/data/zkData</span><br><span class="line"></span><br><span class="line">//在最后添加，指定zookeeper集群主机及端口，机器数必须为奇数</span><br><span class="line">server.1=master188:2888:3888</span><br><span class="line">server.2=master189:2888:3888</span><br><span class="line">server.3=slave190:2888:3888</span><br></pre></td></tr></table></figure>
<h4 id="4、创建并编辑myid"><a href="#4、创建并编辑myid" class="headerlink" title="4、创建并编辑myid"></a>4、创建并编辑<code>myid</code></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//在zookeeper根目录下创建zoo.cfg中配置的目录</span><br><span class="line">mkdir data/zkData/ -p</span><br><span class="line"></span><br><span class="line">//创建并编辑文件</span><br><span class="line">vi myid</span><br><span class="line"></span><br><span class="line">//输入1，即表示当前机器为在zoo.cfg中指定的server.1</span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">//保存退出</span><br><span class="line">:wq</span><br></pre></td></tr></table></figure>
<h4 id="5、拷贝zookeeper到其他机器"><a href="#5、拷贝zookeeper到其他机器" class="headerlink" title="5、拷贝zookeeper到其他机器"></a>5、拷贝zookeeper到其他机器</h4><p>上述操作是在master188机器上进行的，要将zookeeper拷贝到其他zookeeper集群机器上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /home/hadoop</span><br><span class="line"></span><br><span class="line">scp -r zookeeper-3.4.11/ hadoop@master189:/home/hadoop/</span><br><span class="line"></span><br><span class="line">scp -r zookeeper-3.4.11/ hadoop@slave190:/home/hadoop/</span><br></pre></td></tr></table></figure>
<p>集群中各组件的安装目录最好保持一致。</p>
<h4 id="6、修改其他机器的myid文件"><a href="#6、修改其他机器的myid文件" class="headerlink" title="6、修改其他机器的myid文件"></a>6、修改其他机器的<code>myid</code>文件</h4><p><code>myid</code>文件是作为当前机器在zookeeper集群的标识，这些标识在<code>zoo.cfg</code>文件中已经配置好了，但是之前在master188这台机器上配置的<code>myid</code>为1，所以还需要修改其他机器的<code>myid</code>文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//在master189机器上</span><br><span class="line">echo 2 &gt; /home/hadoop/zookeeper-3.4.11/data/zkData/myid</span><br><span class="line">//在slave190机器上</span><br><span class="line">echo 3 &gt; /home/hadoop/zookeeper-3.4.11/data/zkData/myid</span><br></pre></td></tr></table></figure>
<h4 id="7、启动zookeeper集群"><a href="#7、启动zookeeper集群" class="headerlink" title="7、启动zookeeper集群"></a>7、启动zookeeper集群</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd zookeeper-3.4.11/bin/</span><br><span class="line">//分别在master188、master189、slave190上启动</span><br><span class="line">./zkServer.sh start</span><br><span class="line"></span><br><span class="line">//查看状态</span><br><span class="line">./zkServer.sh status</span><br></pre></td></tr></table></figure>
<p>三台机器的zookeeper状态必须只有一个<code>leader</code>，其他都是<code>follower</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//查看进程，若有QuorumpeerMain，则启动成功</span><br><span class="line">jps</span><br></pre></td></tr></table></figure>
<h3 id="四、安装配置Hadoop"><a href="#四、安装配置Hadoop" class="headerlink" title="四、安装配置Hadoop"></a>四、安装配置Hadoop</h3><h4 id="1、下载及安装-1"><a href="#1、下载及安装-1" class="headerlink" title="1、下载及安装"></a>1、下载及安装</h4><p>下载地址：<a href="http://mirrors.hust.edu.cn/apache/hadoop/common/hadoop-2.6.5/hadoop-2.6.5.tar.gz" target="_blank" rel="noopener">http://mirrors.hust.edu.cn/ap…</a></p>
<p>在master88机器上，解压到/home/hadoop/目录下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxcf hadoop-2.6.5.tar.gz -C /home/hadoop/</span><br></pre></td></tr></table></figure>
<h4 id="2、配置"><a href="#2、配置" class="headerlink" title="2、配置"></a>2、配置</h4><p>进入配置文件目录，修改配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd hadoop-2.6.5/etc/hadoop/</span><br></pre></td></tr></table></figure>
<h5 id="1）vi-hadoop-env-sh"><a href="#1）vi-hadoop-env-sh" class="headerlink" title="1）vi hadoop-env.sh"></a>1）vi hadoop-env.sh</h5><p>配置JDK安装路径：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/opt/jdk</span><br></pre></td></tr></table></figure>
<h5 id="2）vi-core-site-xml"><a href="#2）vi-core-site-xml" class="headerlink" title="2）vi core-site.xml"></a>2）vi core-site.xml</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;!-- hdfs地址，ha模式中是连接到nameservice  --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hdfs://ns1&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  &lt;!-- 这里的路径默认是NameNode、DataNode、JournalNode等存放数据的公共目录，也可以单独指定 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/home/hadoop/hadoop-2.6.5/tmp&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 指定ZooKeeper集群的地址和端口。注意，数量一定是奇数，且不少于三个节点--&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master188:2181,master189:2181,slave190:2181&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h5 id="3）vi-hdfs-site-xml"><a href="#3）vi-hdfs-site-xml" class="headerlink" title="3）vi hdfs-site.xml"></a>3）vi hdfs-site.xml</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;!-- 指定副本数，不能超过机器节点数  --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;3&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 为namenode集群定义一个services name --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.nameservices&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;ns1&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- nameservice 包含哪些namenode，为各个namenode起名 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.ha.namenodes.ns1&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master188,master189&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 名为master188的namenode的rpc地址和端口号，rpc用来和datanode通讯 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.namenode.rpc-address.ns1.master188&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master188:9000&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 名为master189的namenode的rpc地址和端口号，rpc用来和datanode通讯 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.namenode.rpc-address.ns1.master189&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master189:9000&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!--名为master188的namenode的http地址和端口号，用来和web客户端通讯 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.namenode.http-address.ns1.master188&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master188:50070&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 名为master189的namenode的http地址和端口号，用来和web客户端通讯 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.namenode.http-address.ns1.master189&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master189:50070&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;!-- namenode间用于共享编辑日志的journal节点列表 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.namenode.shared.edits.dir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;qjournal://master188:8485;master189:8485;slave190:8485/ns1&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 指定该集群出现故障时，是否自动切换到另一台namenode --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.ha.automatic-failover.enabled.ns1&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;true&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- journalnode 上用于存放edits日志的目录 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.journalnode.edits.dir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/home/hadoop/hadoop-2.6.5/tmp/data/dfs/journalnode&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 客户端连接可用状态的NameNode所用的代理类 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.client.failover.proxy.provider.ns1&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 一旦需要NameNode切换，使用ssh方式进行操作 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.ha.fencing.methods&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;sshfence&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 如果使用ssh进行故障切换，使用ssh通信时用的密钥存储的位置 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.ha.fencing.ssh.private-key-files&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/home/hadoop/.ssh/id_rsa&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- connect-timeout超时时间 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;dfs.ha.fencing.ssh.connect-timeout&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;30000&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h5 id="4）vi-mapred-site-xml"><a href="#4）vi-mapred-site-xml" class="headerlink" title="4）vi mapred-site.xml"></a>4）vi mapred-site.xml</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 采用yarn作为mapreduce的资源调度框架 --&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h5 id="5）vi-yarn-site-xml"><a href="#5）vi-yarn-site-xml" class="headerlink" title="5）vi yarn-site.xml"></a>5）vi yarn-site.xml</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 启用HA高可用性 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.resourcemanager.ha.enabled&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;true&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 指定resourcemanager的名字 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.resourcemanager.cluster-id&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;yrc&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 使用了2个resourcemanager,分别指定Resourcemanager的地址 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.resourcemanager.ha.rm-ids&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;rm1,rm2&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;!-- 指定rm1的地址 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.resourcemanager.hostname.rm1&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master188&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;!-- 指定rm2的地址  --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.resourcemanager.hostname.rm2&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master189&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;!-- 指定当前机器master188作为rm1 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.resourcemanager.ha.id&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;rm1&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;!-- 指定zookeeper集群机器 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.resourcemanager.zk-address&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master188:2181,master189:2181,slave190:2181&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;!-- NodeManager上运行的附属服务，默认是mapreduce_shuffle --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;mapreduce_shuffle&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h5 id="6）vi-slaves"><a href="#6）vi-slaves" class="headerlink" title="6）vi slaves"></a>6）vi slaves</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master188</span><br><span class="line">master189</span><br><span class="line">slave190</span><br></pre></td></tr></table></figure>
<h4 id="3、拷贝hadoop到其他机器"><a href="#3、拷贝hadoop到其他机器" class="headerlink" title="3、拷贝hadoop到其他机器"></a>3、拷贝hadoop到其他机器</h4><h5 id="1）拷贝"><a href="#1）拷贝" class="headerlink" title="1）拷贝"></a>1）拷贝</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scp -r hadoop-2.6.5 hadoop@master189:/home/hadoop/</span><br><span class="line"></span><br><span class="line">scp -r hadoop-2.6.5 hadoop@slave190:/home/hadoop/</span><br></pre></td></tr></table></figure>
<h5 id="2）修改yarn-site-xml"><a href="#2）修改yarn-site-xml" class="headerlink" title="2）修改yarn-site.xml"></a>2）修改yarn-site.xml</h5><p>在master189机器，即ResourceManager备用主节点上修改如下属性，表示当前机器作为rm2:：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;property&gt;</span><br><span class="line">  &lt;name&gt;yarn.resourcemanager.ha.id&lt;/name&gt;</span><br><span class="line">  &lt;value&gt;rm2&lt;/value&gt;</span><br><span class="line">&lt;/property&gt;</span><br></pre></td></tr></table></figure>
<p>同时删除slave190机器上的该属性对，因为slave190机器并不作为ResourceManager。</p>
<h4 id="3、启动Hadoop"><a href="#3、启动Hadoop" class="headerlink" title="3、启动Hadoop"></a>3、启动Hadoop</h4><h5 id="1-启动Journalnode"><a href="#1-启动Journalnode" class="headerlink" title="1)启动Journalnode"></a>1)启动Journalnode</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd hadoop-2.6.5/sbin/</span><br><span class="line"></span><br><span class="line">./hadoop-daemon.sh start </span><br><span class="line"></span><br><span class="line">//查看进程JouralNode是否启动</span><br><span class="line">jps</span><br></pre></td></tr></table></figure>
<h5 id="2）格式化-NameNode和ZKFC"><a href="#2）格式化-NameNode和ZKFC" class="headerlink" title="2）格式化 NameNode和ZKFC"></a>2）格式化 NameNode和ZKFC</h5><p>在master188机器上，执行格式化操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd hadoop-2.6.5/bin</span><br><span class="line"></span><br><span class="line">./hdfs namenode -format</span><br><span class="line"></span><br><span class="line">./hdfs zkfc -formatZK</span><br></pre></td></tr></table></figure>
<h5 id="3）备用主节点同步主节点元数据"><a href="#3）备用主节点同步主节点元数据" class="headerlink" title="3）备用主节点同步主节点元数据"></a>3）备用主节点同步主节点元数据</h5><p>在master189（备用主节点）机器上，执行同步操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd hadoop-2.6.5/bin</span><br><span class="line"></span><br><span class="line">./hdfs namenode -bootstrapStanby</span><br></pre></td></tr></table></figure>
<h5 id="4）安装fuster"><a href="#4）安装fuster" class="headerlink" title="4）安装fuster"></a>4）安装fuster</h5><p>若服务器是最小化安装centeros时，有可能系统没有fuster程序，那么跳过这个安装步骤直接进行后面的操作时，将有可能出现以下问题：</p>
<blockquote>
<p>master188作为主节点时，kill掉master188上的NameNode和ResourceManager进程时，可以实现故障转移，master189将从stanby状态自动变成active状态；但是当master189作为主节点时，若kill掉master189上的进程，master188上的进程状态却还是stanby，并不能实现故障自动转移。原因是我们在 hdfs-site.xml中配置了当集群需要故障自动转移时采用SSH方式进行，而因为缺少fuster程序，将在zkfc的日志文件中发现如下错误：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PATH=$PATH:/sbin:/usr/sbin fuser -v -k -n tcp 9000 via ssh: bash: fuser: 未找到命令</span><br><span class="line">Unable to fence service by any configured method</span><br><span class="line">java.lang.RuntimeException: Unable to fence NameNode at master189/192.168.29.189:9000</span><br></pre></td></tr></table></figure>
<p>提示未找到fuster程序，导致无法进行fence，所以可以通过如下命令来安装，Psmisc软件包中包含了fuster程序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//分别在master188、master189、slave190上执行</span><br><span class="line">sudo yum install psmisc</span><br></pre></td></tr></table></figure>
<h5 id="5）启动HDFS、YARN、ZookeeperFailoverController"><a href="#5）启动HDFS、YARN、ZookeeperFailoverController" class="headerlink" title="5）启动HDFS、YARN、ZookeeperFailoverController"></a>5）启动HDFS、YARN、ZookeeperFailoverController</h5><p>在master188机器上：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cd hadoop-2.6.5/sbin</span><br><span class="line"></span><br><span class="line">./start-dfs.sh</span><br><span class="line"></span><br><span class="line">//验证，显示NameNode和DataNode</span><br><span class="line">jps</span><br><span class="line"></span><br><span class="line">./start-yarn.sh</span><br><span class="line"></span><br><span class="line">//验证，显示ResourceManager和NodeManager</span><br><span class="line">jps</span><br><span class="line"></span><br><span class="line">./hadoop-daemon.sh start zkfc</span><br><span class="line"></span><br><span class="line">//验证，显示ZookeeperFailoverController</span><br><span class="line">jps</span><br></pre></td></tr></table></figure>
<p>在master189机器上，启动ResourceManager，备用主节点的ResourceManager需要手动启动：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd hadoop-2.6.5/sbin</span><br><span class="line"></span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br></pre></td></tr></table></figure>
<h5 id="6）查看Namenode、ResourceManager状态"><a href="#6）查看Namenode、ResourceManager状态" class="headerlink" title="6）查看Namenode、ResourceManager状态"></a>6）查看Namenode、ResourceManager状态</h5><p>在master188机器上执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hdfs haadmin -getServiceState master188</span><br><span class="line">yarn rmadmin -getServiceState rm1 </span><br><span class="line"></span><br><span class="line">hdfs haadmin -getServiceState master189</span><br><span class="line">yarn rmadmin -getServiceState rm2</span><br></pre></td></tr></table></figure>
<p>也可以通过Web界面来查看，浏览器中输入 ip:50070 查看HDFS，输入 ip:8088/cluster/cluster 查看YARN。</p>
<h5 id="7）测试高可用"><a href="#7）测试高可用" class="headerlink" title="7）测试高可用"></a>7）测试高可用</h5><h6 id="a-主节点—-gt-备用主节点"><a href="#a-主节点—-gt-备用主节点" class="headerlink" title="a.主节点—&gt;备用主节点"></a>a.主节点—&gt;备用主节点</h6><p>kill掉主节点的namenode，查看备用主节点的namenode状态是否切换为active；</p>
<p>kill掉主节点的ResourceManager，查看备用主节点的ResourceManager是否切换为active；</p>
<h6 id="b-备用主节点—-gt-主节点"><a href="#b-备用主节点—-gt-主节点" class="headerlink" title="b.备用主节点—&gt;主节点"></a>b.备用主节点—&gt;主节点</h6><p>若上述操作执行成功，那么再测试反向故障自动转移</p>
<p>先启动被杀死的原主节点的namenode和ResourceManager</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hadoop-daemon.sh start namenode </span><br><span class="line"></span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br></pre></td></tr></table></figure>
<p>再kill备用主节点的namenode和ResourceManager，查看主节点的状态，若能切换为active，那么Hadoop HA高可用集群搭建完成。</p>
<h3 id="五、安装配置HBase"><a href="#五、安装配置HBase" class="headerlink" title="五、安装配置HBase"></a>五、安装配置HBase</h3><h4 id="1、下载及安装-2"><a href="#1、下载及安装-2" class="headerlink" title="1、下载及安装"></a>1、下载及安装</h4><p>下载地址：<a href="http://mirrors.hust.edu.cn/apache/hbase/1.3.1/hbase-1.3.1-bin.tar.gz" target="_blank" rel="noopener">http://mirrors.hust.edu.cn/ap…</a></p>
<p>在master188机器上，解压到/home/hadoop/目录下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf hbase-1.3.1-bin.tar.gz</span><br></pre></td></tr></table></figure>
<h4 id="2、配置-1"><a href="#2、配置-1" class="headerlink" title="2、配置"></a>2、配置</h4><p>进入hbase-1.3.1/conf/目录，修改配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd hbase-1.3.1/conf/</span><br></pre></td></tr></table></figure>
<h5 id="1）vi-hbase-env-sh"><a href="#1）vi-hbase-env-sh" class="headerlink" title="1）vi hbase-env.sh"></a>1）vi hbase-env.sh</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//配置JDK</span><br><span class="line">export JAVA_HOME=/opt/jdk</span><br><span class="line"></span><br><span class="line">//保存pid文件</span><br><span class="line">export HBASE_PID_DIR=/home/hadoop/data/hbase/pids</span><br><span class="line"></span><br><span class="line">//修改HBASE_MANAGES_ZK，禁用HBase自带的Zookeeper，因为我们是使用独立的Zookeeper</span><br><span class="line">export HBASE_MANAGES_ZK=false</span><br></pre></td></tr></table></figure>
<h5 id="2）vi-hbase-site-xml"><a href="#2）vi-hbase-site-xml" class="headerlink" title="2）vi hbase-site.xml"></a>2）vi hbase-site.xml</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;!-- 设置HRegionServers共享目录，请加上端口号 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.rootdir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hdfs://master/hbase&lt;/value&gt;</span><br><span class="line">    &lt;description&gt;一定要把hadoop中的core-site.xml和hdf-site.xml复制到hbase的conf目录下，才能成功解析该集群名称；如果是hadoop单namenode集群，配置写成hdfs://master:9000/hbase (master是namenode主机名)&lt;/description&gt; </span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 指定HMaster主机 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.master&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;hdfs://master188:60000&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 启用分布式模式 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.cluster.distributed&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;true&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 指定Zookeeper集群位置 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.zookeeper.quorum&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;master188:2181,master189:2181,slave190:2181&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 指定独立Zookeeper安装路径 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.zookeeper.property.dataDir&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;/home/hadoop/zookeeper-3.4.11&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!-- 指定ZooKeeper集群端口 --&gt;</span><br><span class="line">  &lt;property&gt;</span><br><span class="line">    &lt;name&gt;hbase.zookeeper.property.clientPort&lt;/name&gt;</span><br><span class="line">    &lt;value&gt;2181&lt;/value&gt;</span><br><span class="line">  &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure>
<h5 id="3）vi-regionservers"><a href="#3）vi-regionservers" class="headerlink" title="3）vi regionservers"></a>3）vi regionservers</h5><p>修改regionservers文件，因为当前是使用独立的Zookeeper集群，所以要指定RegionServers所在机器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">master188</span><br><span class="line">master189</span><br><span class="line">slave190</span><br></pre></td></tr></table></figure>
<h4 id="4-backup-masters"><a href="#4-backup-masters" class="headerlink" title="4)backup-masters"></a>4)backup-masters</h4><p>vim backup-masters</p>
<p>hadoop2</p>
<h5 id="5-将hadoop的core-site-xml、hdfs-site-xml拷贝到hbase-conf下"><a href="#5-将hadoop的core-site-xml、hdfs-site-xml拷贝到hbase-conf下" class="headerlink" title="5)将hadoop的core-site.xml、hdfs-site.xml拷贝到hbase/conf下"></a>5)将hadoop的core-site.xml、hdfs-site.xml拷贝到hbase/conf下</h5><h5 id="6）创建pid文件保存目录"><a href="#6）创建pid文件保存目录" class="headerlink" title="6）创建pid文件保存目录"></a>6）创建pid文件保存目录</h5><p>在/home/hadoop/目录下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir data/hbase/pids -p</span><br></pre></td></tr></table></figure>
<h4 id="3、拷贝HBase到其他机器"><a href="#3、拷贝HBase到其他机器" class="headerlink" title="3、拷贝HBase到其他机器"></a>3、拷贝HBase到其他机器</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /home/hadoop/</span><br><span class="line"></span><br><span class="line">scp -r hbase-1.3.1 hadoop@master189:/home/hadoop/</span><br><span class="line"></span><br><span class="line">scp -r hbase-1.3.1 hadoop@slave190:/home/hadoop/</span><br></pre></td></tr></table></figure>
<h4 id="4、启动HBase"><a href="#4、启动HBase" class="headerlink" title="4、启动HBase"></a>4、启动HBase</h4><p>在主节点上启动HBase（这里的主节点是指NameNode状态为active的节点，而非指文中对本实验的机器声明）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd hbase-1.3.1/bin</span><br><span class="line"></span><br><span class="line">./start-hbase.sh</span><br><span class="line"></span><br><span class="line">//查看HMaster、Regionserver进程是否启动</span><br><span class="line">jps</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：此时Hadoop集群应处于启动状态，并且是在主节点执行start-hbase.sh启动HBase集群，否则HMaster进程将在启动几秒后消失，而备用的HMaster进程需要在备用主节点单独启动，命令是：<code>./hbase-daemon.sh start master</code>。</p>
</blockquote>
<p>在备用主节点启动HMaster进程，作为备用HMaster：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd hbase-1.3.1/bin</span><br><span class="line"></span><br><span class="line">./hbase-daemon.sh start master</span><br></pre></td></tr></table></figure>
<h4 id="5、HA高可用测试"><a href="#5、HA高可用测试" class="headerlink" title="5、HA高可用测试"></a>5、HA高可用测试</h4><p>在浏览器中输入 <code>ip:16010</code> ，查看主节点和备用主节点上的HMaster的状态，在备用主节点的web界面中，可以看到“Current Active Master: master188”，表示当前HBase主节点是master188机器；</p>
<h5 id="主节点—-gt-备用主节点"><a href="#主节点—-gt-备用主节点" class="headerlink" title="主节点—&gt;备用主节点"></a>主节点—&gt;备用主节点</h5><blockquote>
<p>这里的主节点指使用start-hbase.sh命令启动HBase集群的机器</p>
</blockquote>
<p>kill掉主节点的HMaster进程，在浏览器中查看备用主节点的HBase是否切换为active；</p>
<p>若上述操作成功，则在主节点启动被杀死的HMaster进程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd hbase-1.3.1/bin/</span><br><span class="line"></span><br><span class="line">./hbase-daemon.sh start master</span><br></pre></td></tr></table></figure>
<p>然后，kill掉备用主节点的HMaster进程，在浏览器中查看主节点的HBase是否切换为active，若操作成功，则HBase高可用集群搭建完成；</p>
<h4 id="6、HBase基本操作"><a href="#6、HBase基本操作" class="headerlink" title="6、HBase基本操作"></a>6、HBase基本操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//启动HBase</span><br><span class="line">[root@vnet ~] start-hbase.sh</span><br><span class="line"></span><br><span class="line">//进入HBase Shell</span><br><span class="line">[root@vnet ~] hbase shell</span><br><span class="line"></span><br><span class="line">//查看当前HBase有哪些表</span><br><span class="line">hbase(main):&gt; list</span><br><span class="line"></span><br><span class="line">//创建表t_user，cf1和cf2是列族，列族一般不超过3个</span><br><span class="line">hbase(main):&gt; create &apos;t_user&apos;,&apos;cf1&apos;,&apos;cf2&apos;</span><br><span class="line"></span><br><span class="line">//获得表t_user的描述信息</span><br><span class="line">hbase(main):&gt; describe &apos;t_user&apos;</span><br><span class="line"></span><br><span class="line">//禁用表</span><br><span class="line">hbase(main):&gt; disable &apos;t_user&apos;</span><br><span class="line"></span><br><span class="line">//删除表，删除表之前要先把表禁用掉</span><br><span class="line">hbase(main):&gt; drop &apos;t_user&apos;</span><br><span class="line"></span><br><span class="line">//查询表是否存在</span><br><span class="line">hbase(main):&gt; exists &apos;t_user&apos;</span><br></pre></td></tr></table></figure>
<h3 id="六、集群启动结果"><a href="#六、集群启动结果" class="headerlink" title="六、集群启动结果"></a>六、集群启动结果</h3><p>Hadoop + Zookeeper + HBase 高可用集群启动后，进程状态如下：</p>
<table>
<thead>
<tr>
<th>描述</th>
<th>master188</th>
<th>master189</th>
<th>slave190</th>
</tr>
</thead>
<tbody>
<tr>
<td>HDFS主</td>
<td>NameNode</td>
<td>NameNode</td>
<td></td>
</tr>
<tr>
<td>HDFS从</td>
<td>DataNode</td>
<td>DataNode</td>
<td>DataNode</td>
</tr>
<tr>
<td>YARN主</td>
<td>ResourceManager</td>
<td>ResourceManager</td>
<td></td>
</tr>
<tr>
<td>YARN从</td>
<td>NodeManager</td>
<td>NodeManager</td>
<td>NodeManager</td>
</tr>
<tr>
<td>HBase主</td>
<td>HMaster</td>
<td>HMaster</td>
<td></td>
</tr>
<tr>
<td>HBase从</td>
<td>HRegionServer</td>
<td>HRegionServer</td>
<td>HRegionServer</td>
</tr>
<tr>
<td>Zookeeper独立进程</td>
<td>QuorumPeerMain</td>
<td>QuorumPeerMain</td>
<td>QuorumPeerMain</td>
</tr>
<tr>
<td>NameNodes数据同步</td>
<td>JournalNode</td>
<td>JournalNode</td>
<td>JournalNode</td>
</tr>
<tr>
<td>主备故障切换</td>
<td>DFSZKFailoverController</td>
<td>DFSZKFailoverController</td>
</tr>
</tbody>
</table>
<h3 id="七、总结"><a href="#七、总结" class="headerlink" title="七、总结"></a>七、总结</h3><p>需要注意的地方：</p>
<blockquote>
<p>1）备用节点上的NameNode、ResourceManager、HMaster均需单独启动；</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hadoop-daemon.sh start namenode</span><br><span class="line"></span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br><span class="line"></span><br><span class="line">hbase-daemon.sh start master</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2）可以使用-forcemanual参数强制切换主节点与备用主节点，但强制切换后集群的自动故障转移将会失效，需要重新格式化zkfc：<code>hdfs zdfc -formatZK</code>;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hdfs haadmin -transitionToActive/transitionToStandby  -forcemanual  master189</span><br><span class="line">yarn rmadmin -transitionToActive/transitionToStandby  -forcemanual  rm2</span><br></pre></td></tr></table></figure>
<blockquote>
<p>3）在备用主节点同步主节点的元数据时，主节点的HDFS必须已经启动；</p>
<p>4）无法查看standby状态的节点上的hdfs；</p>
<p>5）格式化namenode时要先启动各个JournalNode机器上的journalnode进程：<code>hadoop-daemon.sh start journalnode</code>；</p>
<p>6）若遇到问题，可以先考虑是哪个组件出现问题，然后查看该组件或与该组件相关的组件的日志信息；若各组件web页面无法访问，或存在其他连接问题，可以从「防火墙是否关闭」、「端口是否被占用」、「SSH」、「集群机器是否处于同一网段」内等角度考虑；</p>
</blockquote>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/03/Hadoop/9-hadoop自定义Key注意事项/" rel="next" title>
                <i class="fa fa-chevron-left"></i> 
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/04/03/Hadoop/面试点/" rel="prev" title>
                 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">42</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Hadoop-HA高可用集群搭建（Hadoop-Zookeeper-HBase）"><span class="nav-number">1.</span> <span class="nav-text">Hadoop HA高可用集群搭建（Hadoop+Zookeeper+HBase）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、服务器环境"><span class="nav-number">1.0.1.</span> <span class="nav-text">一、服务器环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、集群规划"><span class="nav-number">1.0.2.</span> <span class="nav-text">二、集群规划</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、安装配置Zookeeper"><span class="nav-number">1.0.3.</span> <span class="nav-text">三、安装配置Zookeeper</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、下载及安装"><span class="nav-number">1.0.3.1.</span> <span class="nav-text">1、下载及安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、拷贝-zoo-sample-cfg"><span class="nav-number">1.0.3.2.</span> <span class="nav-text">2、拷贝 zoo_sample.cfg</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、修改-zoo-cfg"><span class="nav-number">1.0.3.3.</span> <span class="nav-text">3、修改 zoo.cfg</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4、创建并编辑myid"><span class="nav-number">1.0.3.4.</span> <span class="nav-text">4、创建并编辑myid</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5、拷贝zookeeper到其他机器"><span class="nav-number">1.0.3.5.</span> <span class="nav-text">5、拷贝zookeeper到其他机器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6、修改其他机器的myid文件"><span class="nav-number">1.0.3.6.</span> <span class="nav-text">6、修改其他机器的myid文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7、启动zookeeper集群"><span class="nav-number">1.0.3.7.</span> <span class="nav-text">7、启动zookeeper集群</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、安装配置Hadoop"><span class="nav-number">1.0.4.</span> <span class="nav-text">四、安装配置Hadoop</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、下载及安装-1"><span class="nav-number">1.0.4.1.</span> <span class="nav-text">1、下载及安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、配置"><span class="nav-number">1.0.4.2.</span> <span class="nav-text">2、配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1）vi-hadoop-env-sh"><span class="nav-number">1.0.4.2.1.</span> <span class="nav-text">1）vi hadoop-env.sh</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2）vi-core-site-xml"><span class="nav-number">1.0.4.2.2.</span> <span class="nav-text">2）vi core-site.xml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3）vi-hdfs-site-xml"><span class="nav-number">1.0.4.2.3.</span> <span class="nav-text">3）vi hdfs-site.xml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4）vi-mapred-site-xml"><span class="nav-number">1.0.4.2.4.</span> <span class="nav-text">4）vi mapred-site.xml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5）vi-yarn-site-xml"><span class="nav-number">1.0.4.2.5.</span> <span class="nav-text">5）vi yarn-site.xml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6）vi-slaves"><span class="nav-number">1.0.4.2.6.</span> <span class="nav-text">6）vi slaves</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、拷贝hadoop到其他机器"><span class="nav-number">1.0.4.3.</span> <span class="nav-text">3、拷贝hadoop到其他机器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1）拷贝"><span class="nav-number">1.0.4.3.1.</span> <span class="nav-text">1）拷贝</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2）修改yarn-site-xml"><span class="nav-number">1.0.4.3.2.</span> <span class="nav-text">2）修改yarn-site.xml</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、启动Hadoop"><span class="nav-number">1.0.4.4.</span> <span class="nav-text">3、启动Hadoop</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-启动Journalnode"><span class="nav-number">1.0.4.4.1.</span> <span class="nav-text">1)启动Journalnode</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2）格式化-NameNode和ZKFC"><span class="nav-number">1.0.4.4.2.</span> <span class="nav-text">2）格式化 NameNode和ZKFC</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3）备用主节点同步主节点元数据"><span class="nav-number">1.0.4.4.3.</span> <span class="nav-text">3）备用主节点同步主节点元数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4）安装fuster"><span class="nav-number">1.0.4.4.4.</span> <span class="nav-text">4）安装fuster</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5）启动HDFS、YARN、ZookeeperFailoverController"><span class="nav-number">1.0.4.4.5.</span> <span class="nav-text">5）启动HDFS、YARN、ZookeeperFailoverController</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6）查看Namenode、ResourceManager状态"><span class="nav-number">1.0.4.4.6.</span> <span class="nav-text">6）查看Namenode、ResourceManager状态</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7）测试高可用"><span class="nav-number">1.0.4.4.7.</span> <span class="nav-text">7）测试高可用</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#a-主节点—-gt-备用主节点"><span class="nav-number">1.0.4.4.7.1.</span> <span class="nav-text">a.主节点—&gt;备用主节点</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#b-备用主节点—-gt-主节点"><span class="nav-number">1.0.4.4.7.2.</span> <span class="nav-text">b.备用主节点—&gt;主节点</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#五、安装配置HBase"><span class="nav-number">1.0.5.</span> <span class="nav-text">五、安装配置HBase</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、下载及安装-2"><span class="nav-number">1.0.5.1.</span> <span class="nav-text">1、下载及安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、配置-1"><span class="nav-number">1.0.5.2.</span> <span class="nav-text">2、配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1）vi-hbase-env-sh"><span class="nav-number">1.0.5.2.1.</span> <span class="nav-text">1）vi hbase-env.sh</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2）vi-hbase-site-xml"><span class="nav-number">1.0.5.2.2.</span> <span class="nav-text">2）vi hbase-site.xml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3）vi-regionservers"><span class="nav-number">1.0.5.2.3.</span> <span class="nav-text">3）vi regionservers</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-backup-masters"><span class="nav-number">1.0.5.3.</span> <span class="nav-text">4)backup-masters</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-将hadoop的core-site-xml、hdfs-site-xml拷贝到hbase-conf下"><span class="nav-number">1.0.5.3.1.</span> <span class="nav-text">5)将hadoop的core-site.xml、hdfs-site.xml拷贝到hbase/conf下</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6）创建pid文件保存目录"><span class="nav-number">1.0.5.3.2.</span> <span class="nav-text">6）创建pid文件保存目录</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3、拷贝HBase到其他机器"><span class="nav-number">1.0.5.4.</span> <span class="nav-text">3、拷贝HBase到其他机器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4、启动HBase"><span class="nav-number">1.0.5.5.</span> <span class="nav-text">4、启动HBase</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5、HA高可用测试"><span class="nav-number">1.0.5.6.</span> <span class="nav-text">5、HA高可用测试</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#主节点—-gt-备用主节点"><span class="nav-number">1.0.5.6.1.</span> <span class="nav-text">主节点—&gt;备用主节点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6、HBase基本操作"><span class="nav-number">1.0.5.7.</span> <span class="nav-text">6、HBase基本操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#六、集群启动结果"><span class="nav-number">1.0.6.</span> <span class="nav-text">六、集群启动结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#七、总结"><span class="nav-number">1.0.7.</span> <span class="nav-text">七、总结</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
